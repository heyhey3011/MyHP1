<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'unsafe-inline' https://cdn.tailwindcss.com https://www.googleapis.com; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com https://cdn.tailwindcss.com; font-src 'self' https://fonts.gstatic.com; img-src 'self' data: https:; connect-src 'self' https://www.googleapis.com; frame-src https://www.youtube.com; upgrade-insecure-requests;">
    <title>おすすめ動画一覧 - heyhey公式</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'brand-green': '#B4D455',
                        'kimono-black': '#1A1A1A',
                        'pure-white': '#FFFFFF',
                        'accent-gold': '#D8B25F',
                        'accent-pink': '#F4A7B9'
                    },
                    fontFamily: {
                        'zen': ['Zen Kaku Gothic Antique', 'sans-serif'],
                        'noto': ['Noto Sans JP', 'sans-serif']
                    }
                }
            }
        }
    </script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Zen+Kaku+Gothic+Antique:wght@300;400;500;700&family=Noto+Sans+JP:wght@100;300;400;500;700&display=swap" rel="stylesheet">
    <style>
        body {
            background-image: url('必要画像/washi-texture.png');
            background-repeat: repeat;
            background-color: #F8F5EF; /* 生成りのような色を背景色として指定 */
        }
        .animate-on-scroll {
            opacity: 0;
            transform: translateY(30px);
            transition: opacity 0.8s ease-out, transform 0.8s ease-out;
        }
        .animated {
            opacity: 1;
            transform: translateY(0);
        }
    </style>
</head>
<body class="font-noto">
    <!-- ヘッダー -->
    <header class="bg-pure-white fixed top-0 w-full z-50 transition-all duration-300">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center py-4">
                <div class="flex items-center">
                    <a href="index.html" class="flex items-center">
                        <img src="必要画像/吟ねこ.jpg" alt="heyhey Logo" class="h-8 w-8 rounded-full object-cover">
                        <span class="font-zen font-bold text-kimono-black ml-3">heyheyのホームページ</span>
                    </a>
                </div>
                <nav class="hidden md:flex space-x-8">
                    <a href="about.html" class="text-kimono-black hover:text-brand-green transition-colors">詳細プロフィール</a>
                    <a href="blog.html" class="text-kimono-black hover:text-brand-green transition-colors">個人ブログ</a>
                    <a href="contact.html" class="text-kimono-black hover:text-brand-green transition-colors">お問い合わせ</a>
                </nav>
                <div class="md:hidden">
                    <button id="mobile-menu-button" class="text-kimono-black focus:outline-none">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
                        </svg>
                    </button>
                </div>
            </div>
        </div>
        <div id="mobile-menu" class="hidden md:hidden bg-pure-white border-t">
            <div class="px-2 pt-2 pb-3 space-y-1">
                <a href="about.html" class="block px-3 py-2 text-kimono-black hover:text-brand-green transition-colors">詳細プロフィール</a>
                <a href="blog.html" class="block px-3 py-2 text-kimono-black hover:text-brand-green transition-colors">個人ブログ</a>
                <a href="contact.html" class="block px-3 py-2 text-kimono-black hover:text-brand-green transition-colors">お問い合わせ</a>
            </div>
        </div>
    </header>

    <!-- メインコンテンツ -->
    <main class="py-24 mt-16">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 bg-white/80 backdrop-blur-sm shadow-xl rounded-lg p-8 md:p-12">
            <h1 class="text-4xl font-bold text-center font-zen mb-16 animate-on-scroll">おすすめ動画一覧</h1>

            <section class="mb-20 animate-on-scroll">
                <h2 class="text-3xl font-bold font-zen mb-8 border-b-4 border-brand-green pb-2">新着動画</h2>
                <div id="latest-videos-grid" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-8">
                    <div class="col-span-full text-center text-gray-500">読み込み中...</div>
                </div>
            </section>

            <section class="mb-20 animate-on-scroll">
                <h2 class="text-3xl font-bold font-zen mb-8 border-b-4 border-accent-gold pb-2">人気の動画</h2>
                <div id="popular-videos-grid" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-8">
                    <div class="col-span-full text-center text-gray-500">読み込み中...</div>
                </div>
            </section>

            <section class="mb-20 animate-on-scroll">
                <h2 class="text-3xl font-bold font-zen mb-8 border-b-4 border-accent-pink pb-2">ピックアップリスト１：初心の方向け</h2>
                <div id="pickup-list-1-grid" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-8">
                    <div class="col-span-full text-center text-gray-500">読み込み中...</div>
                </div>
            </section>

            <section class="animate-on-scroll">
                <h2 class="text-3xl font-bold font-zen mb-8 border-b-4 border-kimono-black pb-2">ピックアップリスト２：中級者の方向け</h2>
                <div id="pickup-list-2-grid" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-8">
                    <div class="col-span-full text-center text-gray-500">読み込み中...</div>
                </div>
            </section>

        </div>
    </main>

    <!-- フッター -->
    <footer class="bg-kimono-black text-pure-white py-12">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex flex-col items-center">
                <p class="text-center text-gray-400">© 2025 heyhey. All rights reserved.</p>
            </div>
        </div>
    </footer>
    
    <!-- 設定ファイルを読み込み -->
    <script src="config.local.js"></script>
    <script src="config.js"></script>
    
    <script>
        // モバイルメニューの切り替え
        const mobileMenuButton = document.getElementById('mobile-menu-button');
        const mobileMenu = document.getElementById('mobile-menu');
        
        if (mobileMenuButton) {
            mobileMenuButton.addEventListener('click', () => {
                mobileMenu.classList.toggle('hidden');
            });
        }

        // スクロール時のヘッダー効果
        window.addEventListener('scroll', () => {
            const header = document.querySelector('header');
            if (window.scrollY > 10) {
                header.classList.add('shadow-lg', 'bg-white/90', 'backdrop-blur-md');
            } else {
                header.classList.remove('shadow-lg', 'bg-white/90', 'backdrop-blur-md');
            }
        });
        
        // スクロールアニメーションの設定
        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.classList.add('animated');
                    observer.unobserve(entry.target);
                }
            });
        }, { threshold: 0.1 });
        
        document.querySelectorAll('.animate-on-scroll').forEach(el => {
            observer.observe(el);
        });


        // --- YouTube API連携 ---
        document.addEventListener('DOMContentLoaded', () => {
            // config.jsが読み込まれるのを少し待つ
            setTimeout(() => {
                // APIキーとチャンネルIDの設定チェック
                if (typeof CONFIG === 'undefined' || !CONFIG.YOUTUBE || !CONFIG.YOUTUBE.API_KEY || !CONFIG.YOUTUBE.CHANNEL_ID) {
                    console.error('CRITICAL: CONFIG object or API Key/Channel ID is not defined.');
                    return;
                }

                const { API_KEY, CHANNEL_ID } = CONFIG.YOUTUBE;

                // ----- 共通関数: 動画カード生成 -----
                function createVideoCard(video) {
                    const videoId = video.id.videoId || video.id;
                    const title = video.snippet.title;
                    const thumbnail = video.snippet.thumbnails.medium.url;
                    let viewCountText = '';
                    if (video.statistics && video.statistics.viewCount) {
                        const views = parseInt(video.statistics.viewCount);
                        if (views >= 10000) viewCountText = `${Math.floor(views / 10000)}万 回再生`;
                        else viewCountText = `${views.toLocaleString()} 回再生`;
                    }
                    return `
                        <a href="https://www.youtube.com/watch?v=${videoId}" target="_blank" rel="noopener noreferrer" class="block bg-white rounded-lg shadow-md overflow-hidden hover:shadow-xl transition-shadow duration-300 group">
                            <div class="relative aspect-video">
                                <img src="${thumbnail}" alt="${title}" class="w-full h-full object-cover">
                            </div>
                            <div class="p-4">
                                <h3 class="font-zen font-bold text-kimono-black mb-2 line-clamp-2 h-14 group-hover:text-brand-green transition-colors">${title}</h3>
                                ${viewCountText ? `<p class="text-sm text-gray-600">${viewCountText}</p>` : ''}
                            </div>
                        </a>`;
                }

                // ----- recommended-videos.html用の関数 -----
                async function fetchVideos(url, elementId) {
                     const gridElement = document.getElementById(elementId);
                     if (!gridElement) return;

                     try {
                        const response = await fetch(url);
                        if (!response.ok) {
                            const errorData = await response.json();
                            throw new Error(`API response was not ok: ${response.status}. ${JSON.stringify(errorData.error.message)}`);
                        }
                        const data = await response.json();
                        if (data.items && data.items.length > 0) {
                             gridElement.innerHTML = data.items.map(createVideoCard).join('');
                        } else {
                             gridElement.innerHTML = '<div class="col-span-full text-center text-gray-500">動画が見つかりませんでした。</div>';
                        }
                    } catch(error) {
                        console.error(`Failed to fetch videos for ${elementId}:`, error);
                        gridElement.innerHTML = '<div class="col-span-full text-center text-red-500">エラーが発生しました。後でもう一度お試しください。</div>';
                    }
                }

                // 動画を取得
                const LATEST_URL = `https://www.googleapis.com/youtube/v3/search?part=snippet&channelId=${CHANNEL_ID}&order=date&maxResults=4&type=video&key=${API_KEY}`;
                const POPULAR_URL = `https://www.googleapis.com/youtube/v3/search?part=snippet&channelId=${CHANNEL_ID}&order=viewCount&maxResults=4&type=video&key=${API_KEY}`;
                const PICKUP1_URL = `https://www.googleapis.com/youtube/v3/videos?part=snippet,statistics&id=${CONFIG.YOUTUBE.PICKUP_LIST_1_IDS.join(',')}&key=${API_KEY}`;
                const PICKUP2_URL = `https://www.googleapis.com/youtube/v3/videos?part=snippet,statistics&id=${CONFIG.YOUTUBE.PICKUP_LIST_2_IDS.join(',')}&key=${API_KEY}`;

                fetchVideos(LATEST_URL, 'latest-videos-grid');
                fetchVideos(POPULAR_URL, 'popular-videos-grid');
                fetchVideos(PICKUP1_URL, 'pickup-list-1-grid');
                fetchVideos(PICKUP2_URL, 'pickup-list-2-grid');
            }, 100); // 100ミリ秒待機
        });
    </script>
</body>
</html>